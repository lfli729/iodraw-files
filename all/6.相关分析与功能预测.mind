{"root":{"data":{"id":"d37mjajsaj9c","created":1722825121267,"text":"相关分析与功能预测"},"children":[{"data":{"id":"d37mjthm5jpc","created":1722825162495,"text":"相关性分析"},"children":[{"data":{"id":"d37mk0izj94w","created":1722825177815,"text":"脚本association_analysis.sh：bin/association_analysis/association_analysis_module.py"},"children":[]},{"data":{"id":"d37mkha8k6ps","created":1722825214291,"text":"结果路径：Analysis_output/Association_analysis"},"children":[]},{"data":{"id":"d37mklm77xts","created":1722825223722,"text":"分析相关的sh：Analysis_output/Association_analysis/work_sh"},"children":[]},{"data":{"id":"d37mkx369f5s","created":1722825248693,"text":"分析内容"},"children":[{"data":{"id":"d37ml1vts2dc","created":1722825259133,"text":"相关性网络图"},"children":[{"data":{"id":"d37mlh0eokxs","created":1722825292061,"text":"网络图是相关性分析的一种表现形式，根据各个物种在各个样品中的丰度以及变化情况，"},"children":[]},{"data":{"id":"d37mlmvk5ngg","created":1722825304829,"text":"进行斯皮尔曼(Spearman )秩相关分析并筛选相关性大于0.1且p值小于0.05的数据构建相关性网络。"},"children":[]},{"data":{"id":"d37mlrzvb20w","created":1722825315973,"text":"基于网络图的分析，可以获得物种在环境样本中的共存关系，得到物种在同一环境下的相互作用的情况及重要的模式信息，进一步解释样本间表型差异的形成机制。"},"children":[]}]},{"data":{"id":"d37ml5ggro5c","created":1722825266911,"text":"环境因子分析"},"children":[{"data":{"id":"d37mq8eu66m8","created":1722825665164,"text":"RDA（Redundancy Analysis）和 CCA（Canonical Correspondence Analysis）是多元统计分析中常用的技术，主要用于探索多变量数据之间的关系，特别是在生态学和环境科学领域"},"children":[]},{"data":{"id":"d37ms38286ps","created":1722825810598,"text":"VPA，全称Variance Partitioning Analysis，中文称为方差分解分析，该分析的目的是确定指定的环境因子对群落结构变化的解释比例"},"children":[]},{"data":{"id":"d37mtgk64i68","created":1722825917993,"text":"方差膨胀因子（Variance Inflation Factor，VIF）分析时目前常用的环境因子筛选方法，VIF是衡量多元线性回归模型中复杂(多重)共线性严重程度的一种度量"},"children":[]},{"data":{"id":"d37mxcqiliww","created":1722826223126,"text":"相关性热图（Heatmap）是物种与环境因子之间的相关性关系的一种展现形式，通过相关性系数如Pearson、Spearman、Kendal算法计算相关系数，同时计算相关性p值，直观的用热图的形式进行可视化。"},"children":[]}]}]},{"data":{"id":"d37mkzo86yo0","created":1722825254319,"text":"分析步骤"},"children":[{"data":{"id":"d37mm0mi5ips","created":1722825334756,"text":"相关性网络图"},"children":[{"data":{"id":"d37mm44kgef4","created":1722825342379,"text":"bin/association_analysis/network/network.py"},"children":[]},{"data":{"id":"d37mm93n6ozk","created":1722825353207,"text":"该脚本默认是获取属的biom文件和进行属水平的相关性分析。"},"children":[]},{"data":{"id":"d37mmedyl69s","created":1722825364715,"text":"运行生成的sh：Analysis_output/Association_analysis/Network/work_sh/network.sh"},"children":[]},{"data":{"id":"d37mp8lnjq4g","created":1722825587212,"text":"bin/association_analysis/network/bin/BiomToMergeleveldata.r"},"children":[{"data":{"id":"d37mph6qjm68","created":1722825605901,"text":"将biom数据处理成画相关性分析网络图的数据，默认是处理种水平的，也可以生成其他水平数据。"},"children":[]}]},{"data":{"id":"d37mpl31nym8","created":1722825614385,"text":"bin/association_analysis/network/bin/corr.cal.r"},"children":[{"data":{"id":"d37mpp4p3rpc","created":1722825623191,"text":"使用Spearman计算相关性的值，以及筛选数据"},"children":[]}]},{"data":{"id":"d37mpt191fy8","created":1722825631690,"text":"bin/association_analysis/network/bin/corr.igraph.r"},"children":[{"data":{"id":"d37mpwp3afi8","created":1722825639662,"text":"画相关性网络图"},"children":[]}]},{"data":{"id":"d37mq0n8c000","created":1722825648257,"text":"bin/association_analysis/network/hubplot.R"},"children":[{"data":{"id":"d37mq53unyf4","created":1722825657969,"text":"绘制节点Zi-Pi分布图"},"children":[]}]}]},{"data":{"id":"d37mqcyp3qio","created":1722825675071,"text":"环境因子分析"},"children":[{"data":{"id":"d37mqg41kp34","created":1722825681925,"text":"若大脚本有传env.txt文件的话【进行环境因子分析】"},"children":[]},{"data":{"id":"d37mqlhezfgg","created":1722825693618,"text":"进行RDA/CCA分析，使用的脚本是"},"children":[{"data":{"id":"d37mqpoj8l4w","created":1722825702755,"text":"bin/association_analysis/RDA_CCA/RDA_CCA_analysis.py"},"children":[]}]},{"data":{"id":"d37mr204t8u8","created":1722825729578,"text":"回归分析"},"children":[{"data":{"id":"d37mr2uplm9s","created":1722825731427,"text":"bin/association_analysis/env_regression/env_regression_analysis.py "},"children":[{"data":{"id":"d37mvfmsofsw","created":1722826072703,"text":"限样本>=5，默认alpha多样性指数"},"children":[]}]}]},{"data":{"id":"d37mr6xx3zsw","created":1722825740328,"text":"方差膨胀因子VIF分析"},"children":[{"data":{"id":"d37mr7i78ef4","created":1722825741554,"text":"bin/association_analysis/VIF/vif_analysis.py"},"children":[]}]},{"data":{"id":"d37mrb639rls","created":1722825749529,"text":"VPA方差分解分析"},"children":[{"data":{"id":"d37mrdzh9a0w","created":1722825755660,"text":"bin/association_analysis/VPA/vpa_analysis.py "},"children":[]}]},{"data":{"id":"d37mrljj09a8","created":1722825772109,"text":"相关性分析"},"children":[{"data":{"id":"d37mrmqyso3k","created":1722825774736,"text":"bin/association_analysis/env_corr/env_tax_alpha_corr_analysis.py"},"children":[]}]}]}]}]},{"data":{"id":"d37mjxm77sw0","created":1722825171479,"text":"功能预测"},"children":[{"data":{"id":"d37mylaizqio","created":1722826320114,"text":"脚本function_analysis.sh：bin/function_analysis/function_analysis_module.py"},"children":[]},{"data":{"id":"d37myq38gzy8","created":1722826330557,"text":"预处理"},"children":[{"data":{"id":"d37myyrg6olc","created":1722826349436,"text":"获取top otu table/biom/rep.fasta 若果OTU太多的话只选前10000个。"},"children":[]},{"data":{"id":"d37mz2tncav4","created":1722826358276,"text":"脚本在这个sh：Analysis_output/Function_prediction/work_sh/get_topdata.sh"},"children":[]},{"data":{"id":"d37mz7qii1hc","created":1722826368970,"text":"使用到bin/function_analysis/Getleveldata.r 获取不同层级的数据，可选有：门纲目科属种、otu；"},"children":[]},{"data":{"id":"d37mzcekfjsw","created":1722826379132,"text":"将提取的前10000个数据使用biom convert 转换成json格式和tsv --header-key taxonomy格式；"},"children":[]},{"data":{"id":"d37mzhqlrxmo","created":1722826390744,"text":"再将筛选的OTU转成fna格式，用于功能预测分析"},"children":[]}]},{"data":{"id":"d37mzj96rke8","created":1722826394044,"text":"进行功能预测分析：Analysis_output/Function_prediction/work_sh/function_predict.sh"},"children":[]},{"data":{"id":"d37mznjajb40","created":1722826403362,"text":"若果是16S分析：PICRUSt2、FAPROTAX、BugBase"},"children":[{"data":{"id":"d37nbj1f622o","created":1722827333944,"text":"分析内容"},"children":[{"data":{"id":"d37nc1vpkl4w","created":1722827374958,"text":"PICRUSt2"},"children":[{"data":{"id":"d37nc8o99atc","created":1722827389745,"text":"PICRUSt2 是一款基于样本中的标记基因序列丰度来预测样本功能丰度的软件。"},"children":[]},{"data":{"id":"d37nd01c6cqo","created":1722827449309,"text":"这里的功能是指基因家族，如KEGG同源基因、EC酶分类号等"},"children":[]},{"data":{"id":"d37nd916yn7k","created":1722827468891,"text":"使用PICRUSt2将特征序列（16S rRNA）与微生物基因组数据库（IMG）参考序列比对构建进化树，找到特征序列的“最近物种”"},"children":[]},{"data":{"id":"d37ndtis4s8w","created":1722827513490,"text":"并根据已知物种的基因种类和丰度信息预测未知物种的基因信息，从而结合基因的KEGG通路信息预测整个群落的通路情况"},"children":[]},{"data":{"id":"d37ne4qag45c","created":1722827537889,"text":"PICRUSt2可以将16S rRNA基因序列在多个功能数据库中进行预测，包括MetaCyc 、KEGG、COG、Pfam和TIGRFAM"},"children":[]},{"data":{"id":"d37nej8uusjk","created":1722827569486,"text":"默认只提供最常用的KEGG和COG数据库注释结果。"},"children":[]},{"data":{"id":"d37nfn62gveo","created":1722827656389,"text":"KEGG代谢途径的组成及差异分析，可以观测不同分组的样品之间微生物群落的功能基因在代谢途径上的差异和变化"},"children":[]}]},{"data":{"id":"d37nca9rwsn4","created":1722827393223,"text":"FAPROTAX"},"children":[{"data":{"id":"d37nlxmkdwqo","created":1722828149339,"text":"FAPROTAX较适用于对环境样本（如海洋、湖泊等）的生物地球化学循环过程（特别是碳、氢、氮、磷、硫等元素循环）进行功能注释预测"},"children":[]},{"data":{"id":"d37nm24b52bk","created":1722828159119,"text":"因其基于已发表验证的可培养菌文献，其预测准确度较好，FAPROTAX比较灵活，通过识别的是菌的属、种的名称进行生态功能预测。"},"children":[]}]},{"data":{"id":"d37nmzxgpeyo","created":1722828232716,"text":"分支主题"},"children":[{"data":{"id":"d37nnclmbugw","created":1722828260298,"text":"分支主题"},"children":[]}]}]},{"data":{"id":"d37nblo26gw0","created":1722827339667,"text":"分析步骤"},"children":[{"data":{"id":"d37nfcdv42dc","created":1722827632916,"text":"PICRUSt2"},"children":[{"data":{"id":"d37nfdpl3s3k","created":1722827635801,"text":"脚本是：bin/function_analysis/PICRUSt2/run_picrust2.py生成sh【picrust2_1.sh、picrust2_2.sh、picrust2_3.sh、k2s_stamp.sh】"},"children":[]},{"data":{"id":"d37nhr8gjwn4","created":1722827821969,"text":"结果在：Analysis_output/Function_prediction/Picrust"},"children":[]},{"data":{"id":"d37nhxsngc8w","created":1722827836251,"text":"异常记录"},"children":[{"data":{"id":"d37ni1kmfh8g","created":1722827844472,"text":"描述：生成报告时PICRUSt2的图加载失败"},"children":[]},{"data":{"id":"d37nitqogoao","created":1722827905789,"text":"原因是集群问题导致PICRUSt2结果生成不全"},"children":[]},{"data":{"id":"d37nj4ohg1s0","created":1722827929600,"text":"处理"},"children":[{"data":{"id":"d37njj6u0xds","created":1722827961185,"text":"1.后台执行Analysis_output/Function_prediction/Picrust/work_sh/k2s_stamp.sh"},"children":[]},{"data":{"id":"d37njna2r280","created":1722827970088,"text":"2.后台执行work_sh/result_extract.sh覆盖结果"},"children":[]},{"data":{"id":"d37njzdeumf4","created":1722827996411,"text":"3.前端点击续跑"},"children":[]}]}]}]},{"data":{"id":"d37nlmc1i5mo","created":1722828124758,"text":"FAPROTAX"},"children":[{"data":{"id":"d37nm9rotw5c","created":1722828175771,"text":"脚本是：bin/function_analysis/FAPROTAX/faprotax.py【faprotax.sh、stamp.sh】"},"children":[]},{"data":{"id":"d37nme7soqgw","created":1722828185452,"text":"结果在：Analysis_output/Function_prediction/FAPROTAX"},"children":[]}]},{"data":{"id":"d37nmxjclbsw","created":1722828227509,"text":"分支主题"},"children":[]}]}]},{"data":{"id":"d37mzspel0cg","created":1722826414616,"text":"若果是ITS分析：FUNGuild"},"children":[{"data":{"id":"d37n1d03k1ds","created":1722826537162,"text":"分析内容"},"children":[{"data":{"id":"d37nah3qonb4","created":1722827251367,"text":"FUNGuild(Fungi Functional Guild)是一种可用于由生态协会分类学解析真菌的工具，用简单而一致的方法将大型序列库分类为具有生态意义的类别。"},"children":[]},{"data":{"id":"d37namx8r8jk","created":1722827264035,"text":"按照营养方式将真菌分为三大类:病理营养型(pathotroph),共生营养型(symbiotroph)，腐生营养型(saprotroph)。"},"children":[]},{"data":{"id":"d37nb1guumm8","created":1722827295696,"text":"将三大类进一步又分为12类,成为guilds。"},"children":[]},{"data":{"id":"d37nb4af9n28","created":1722827301837,"text":"真菌数据与软件自带数据库比对结果包含：物种名称，物种分类水平，营养方式，生长形态，形状，可信度，注意事项和参考文献。"},"children":[]},{"data":{"id":"d37nbbt4rwg0","created":1722827318206,"text":"将可信度为Highly和Probable的物种挑选出来进行可视化(符合条件的物种个数小于2时不做可视化)。"},"children":[]}]},{"data":{"id":"d37n1g1xmi9s","created":1722826543803,"text":"分析步骤"},"children":[{"data":{"id":"d37n1ioylwqo","created":1722826549549,"text":"主脚本：bin/function_analysis/FUNGuild/funguld.py"},"children":[]},{"data":{"id":"d37n1t44a1og","created":1722826572234,"text":"bin/function_analysis/FUNGuild/Guilds_v1.0.1.py"},"children":[]},{"data":{"id":"d37n22s37hts","created":1722826593274,"text":"bin/function_analysis/FUNGuild/fungi_visualization.pl"},"children":[]},{"data":{"id":"d37n27559gcg","created":1722826602771,"text":"然后使用barplot2.py画图"},"children":[]}]}]}]}]},"template":"right","theme":"fresh-green-compat","version":"1.4.43"}