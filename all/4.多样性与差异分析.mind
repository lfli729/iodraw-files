{"root":{"data":{"id":"d37k9xr4ipkw","created":1722818745915,"text":"多样性与差异分析"},"children":[{"data":{"id":"d37kb2jsq1hc","created":1722818834720,"text":"Alpha多样性"},"children":[{"data":{"id":"d37kd0d38g00","created":1722818986690,"text":"脚本alpha_div_analysis.sh"},"children":[{"data":{"id":"d37kd69ipla8","created":1722818999534,"text":"bin/alpha_div_analysis/alpha_diversity_module.py"},"children":[]},{"data":{"id":"d37khl9bcc8w","created":1722819345630,"text":"alpha_index_and_fraction.sh：bin/alpha_div_analysis/alpha_index_cal/alpha_div_index.py"},"children":[]},{"data":{"id":"d37krvu5ya68","created":1722820152302,"text":"结果路径：Analysis_output/Alpha_diversity"},"children":[]}]},{"data":{"id":"d37kelgbfgn4","created":1722819110961,"text":"分析内容"},"children":[{"data":{"id":"d37keq4wz9xc","created":1722819121156,"text":"Alpha多样性（Alpha diversity）反映的是单个样品物种丰富度（richness）及物种多样性（diversity）"},"children":[]},{"data":{"id":"d37kess18ao0","created":1722819126907,"text":"多种衡量指标：Chao1、Ace、Shannon、Simpson、Coverage、PD_whole_tree"},"children":[]},{"data":{"id":"d37kfbrga77k","created":1722819168231,"text":"Chao1和Ace指数衡量物种丰富度即物种数量的多少"},"children":[]},{"data":{"id":"d37kfhp1bj7k","created":1722819181146,"text":"Shannon和Simpson指数用于衡量物种多样性，受样品群落中物种丰富度和物种均匀度（Community evenness）的影响"},"children":[]},{"data":{"id":"d37kfrxwnu2o","created":1722819203450,"text":"相同物种丰富度的情况下，群落中各物种具有越大的均匀度，则认为群落具有越大的多样性"},"children":[]},{"data":{"id":"d37kfxhomwao","created":1722819215530,"text":"Shannon指数和Simpson指数值越大，说明样品的物种多样性越高"},"children":[]},{"data":{"id":"d37kg6v1zhfk","created":1722819235929,"text":"覆盖率（Coverage），其数值越高，则样本中物种被测出的概率越高，而没有被测出的概率越低。"},"children":[]},{"data":{"id":"d37kgfsqsxkw","created":1722819255380,"text":"该指数反映本次测序结果是否代表了样本中微生物的真实情况"},"children":[]},{"data":{"id":"d37kglhwoo3k","created":1722819267786,"text":"PD_whole_tree是基于系统发育树来计算的一种多样性指数，它用各个样品中OTUs 的代表序列构建出系统发育树的\n距离，将某一个样品中的所有代表序列的枝长加和，从而得到的数值。 数值越大，群落多样性越高。 ","layout_right_offset":{"x":-4,"y":7}},"children":[]}]},{"data":{"id":"d37ki4dcpaf4","created":1722819387233,"text":"步骤"},"children":[{"data":{"id":"d37ki71fq9s0","created":1722819393043,"text":"1.进入qiime环境计算alpha指数"},"children":[{"data":{"id":"d37kifnb5w5c","created":1722819411780,"text":"Analysis_output/Alpha_diversity/alpha_index_dir/work_sh/alpha_index.sh"},"children":[]},{"data":{"id":"d37kio6tbym8","created":1722819430374,"text":"alpha_diversity.py是封装在容器中：需要先source环境才能执行"},"children":[]}]},{"data":{"id":"d37kj2ell91c","created":1722819461319,"text":"2.内部【脚本嵌套】运行split the shared file生成shared的文件"},"children":[{"data":{"id":"d37kj4gg0d8g","created":1722819465785,"text":"bin/alpha_div_analysis/alpha_index_cal/bin/cut_out_shared.py"},"children":[]}]},{"data":{"id":"d37kjd24kz5s","created":1722819484510,"text":"3.mothur需要依赖生成的shared文件进行：计算 alpha 多样性指数的汇总统计"},"children":[{"data":{"id":"d37kjvg86g3k","created":1722819524545,"text":"Analysis_output/Alpha_diversity/alpha_index_dir/work_sh/indices.2.sh"},"children":[]},{"data":{"id":"d37kn88ugjcw","created":1722819787489,"text":"计算 ACE 多样性指数，ACE用于估计群落中未观察到的物种数量"},"children":[]},{"data":{"id":"d37knkyf4jk0","created":1722819815157,"text":"计算稀释曲线上的Shannon 多样性指数。"},"children":[]}]},{"data":{"id":"d37kp4iphaf4","created":1722819936106,"text":"4.合并alpha多样性指数的结果"},"children":[{"data":{"id":"d37kpdz115og","created":1722819956684,"text":"alpha_div_analysis.sh"},"children":[{"data":{"id":"d37kpm44i4u8","created":1722819974407,"text":"alpha_div_stat.py：指数的统计差异，Shannon-Simpson-ACE-Chao1-PD_whole_tree"},"children":[]},{"data":{"id":"d37kpqpm124g","created":1722819984413,"text":"rare_curve.py：稀释曲线"},"children":[]},{"data":{"id":"d37kpui8bo5c","created":1722819992674,"text":"shannon_curve.py：香浓曲线"},"children":[]},{"data":{"id":"d37kpyo82p6o","created":1722820001743,"text":"rank_abund_curve.py：等级丰度曲线"},"children":[]},{"data":{"id":"d37kq3aujxts","created":1722820011819,"text":"species_cumulative_curve_analysis.py：物种积累曲线图"},"children":[]}]}]}]}]},{"data":{"id":"d37kb8lc6dc0","created":1722818847874,"text":"beta多样性"},"children":[{"data":{"id":"d37kqw169k3k","created":1722820074361,"text":"代码beta_div_analysis.sh：bin/beta_div_analysis/beta_diversity_module.py"},"children":[]},{"data":{"id":"d37kroil23nk","created":1722820136363,"text":"结果路径：Analysis_output/Beta_diversity"},"children":[]},{"data":{"id":"d37ktkh2ixhc","created":1722820284293,"text":"分析内容"},"children":[{"data":{"id":"d37ktp4c37y8","created":1722820294406,"text":"使用QIIME软件进行 Beta 多样性(Beta diversity)分析，比较不同样品在物种多样性方面存在的相似程度"},"children":[]},{"data":{"id":"d37ktvjvf8jk","created":1722820308407,"text":"Beta多样性分析主要采用 binary jaccard、 bray curtis、 weighted unifrac(限细菌)、 unweighted unifrac (限细菌)等4种算法计算样品间的距离从而获得样本间的β值"},"children":[]},{"data":{"id":"d37ku6yemtj4","created":1722820333230,"text":"这四个算法主要分为两大类：加权（Bray-Curtis和Weighted Unifrac）与非加权（Jaccard和Unweightde Unifrac）"},"children":[]},{"data":{"id":"d37kucnjfhts","created":1722820345634,"text":"利用非加权的计算方法，主要比较的是物种的有无，如果两个群体的β多样性越小,则说明两个群体的物种类型越相似"},"children":[]},{"data":{"id":"d37kugmta2v4","created":1722820354297,"text":"而加权方法，则需要同时考虑物种有无和物种丰度两个问题。"},"children":[]}]},{"data":{"id":"d37kuqdrb5kw","created":1722820375517,"text":"分析步骤"},"children":[{"data":{"id":"d37kut5u6iv4","created":1722820381569,"text":"1.dist_tree_cal.sh"},"children":[{"data":{"id":"d37kvbz6f474","created":1722820422525,"text":"bin/beta_div_analysis/beta_div_dist_and_tre_cal/beta_div_dist_and_tre_cal.py"},"children":[]},{"data":{"id":"d37kveamx5hc","created":1722820427571,"text":"作用：计算 beta 多样性中的距离矩阵和树信息binary_jaccard、bray_curtis、unweighted_unifrac、weighted_unifrac"},"children":[]},{"data":{"id":"d37kw7q1gbuo","created":1722820491629,"text":"嵌套脚本：Analysis_output/Beta_diversity/Dist_matrix_tree/beta_div_dist.sh"},"children":[{"data":{"id":"d37kwfxts45c","created":1722820509514,"text":"beta_diversity.py 计算四种距离矩阵：binary_jaccard、bray_curtis、unweighted_unifrac、weighted_unifrac"},"children":[]}]},{"data":{"id":"d37le5dd3r40","created":1722821897064,"text":"PCA主成分分析"},"children":[{"data":{"id":"d37lerkhprsw","created":1722821945384,"text":"一种分析和简化数据集的技术，通过将方差进行分解，将多组数据的差异反映在二维坐标图上"},"children":[]},{"data":{"id":"d37lex4ohs74","created":1722821957489,"text":"通过分析不同样品Feature组成可以反映样品的差异和距离，PCA运用方差分解，将多组数据的差异反映在二维坐标图上，坐标轴取能够最大反映方差的两个特征值"},"children":[]}]},{"data":{"id":"d37l8d6jipz4","created":1722821443881,"text":"PCOA主坐标分析法\nprincipal_coordinates.py"},"children":[{"data":{"id":"d37l90c0obnk","created":1722821494278,"text":"原理是假设对N个样品有衡量它们之间差异或距离的数据，就可以用此方法找出一个直角坐标系，将N个样品表示成N个点，\n而使点间的欧式距离的平方正好等于原来的差异数据，实现定性数据的定量转换，从多维数据中提取出最主要的元素和结构"},"children":[]},{"data":{"id":"d37l9a282874","created":1722821515454,"text":"通过主坐标分析可以实现多个样品的分类，进一步展示样品间物种多样性差异"},"children":[]}]},{"data":{"id":"d37l9fm52kn4","created":1722821527542,"text":"UPGMA非加权组平均法\n【样品层次聚类】：upgma_cluster.py"},"children":[{"data":{"id":"d37la2xw969s","created":1722821578319,"text":"原理是：假定的前条件是在进化过程中，每一世系发生趋异的次数相同，即核苷酸或氨基酸的替换速率是均等且恒定的"},"children":[]},{"data":{"id":"d37la7kc785c","created":1722821588383,"text":"通过UPGMA法所产生的系统发生树可以说是物种树的简单体现，在每一次趋异发生后，从共同祖先节点到2个特征间的支的长度一样。\n因此，这种方法较多地用于物种树的重建。"},"children":[]}]},{"data":{"id":"d37laox04dmo","created":1722821626154,"text":"NMDS：nmds.py"},"children":[{"data":{"id":"d37lcvd30hkw","created":1722821796915,"text":"一种适用于生态学研究的排序方法，主要是将多维空间的研究对象（样本或变量）简化到低维空间进行定位、分析和归类，同时又保留对象间原始关系的数据分析方法"},"children":[]},{"data":{"id":"d37ld0pb1z40","created":1722821808538,"text":"类似于PCA或者PCoA，通过样本的分布可以看出组间或组内差异"},"children":[]},{"data":{"id":"d37ld6p69d6o","created":1722821821591,"text":"NMDS原设计的目的是为了克服以前排序方法中包括PCA、PCoA在内的缺点，即线性模型"},"children":[]},{"data":{"id":"d37ldejeff9c","created":1722821838656,"text":"NMDS的模型是非线性的，能更好地反映生态学数据的非线性结构，有的研究认为NMDS的效果优于PCA/PCoA"},"children":[]},{"data":{"id":"d37ldg2q3itc","created":1722821842001,"text":"建议不分组时，样本数量不少于10个；多组样本时，每组样本数量不少于5个。"},"children":[]}]}]},{"data":{"id":"d37lgbh2uscg","created":1722822067078,"text":"2.beta_div_analysis.sh"},"children":[{"data":{"id":"d37lgwwzyghs","created":1722822113753,"text":"PCA和PCOA的图","expandState":"expand"},"children":[{"data":{"id":"d37lgrarjshs","created":1722822101525,"text":"bin/beta_div_analysis/PCA/PCA_or_PCoA.r"},"children":[]}]},{"data":{"id":"d37lgz85z11c","created":1722822118782,"text":"样本间距离聚类热图"},"children":[{"data":{"id":"d37lh77rk5xc","created":1722822136172,"text":"bin/beta_div_analysis/SamHeatmap/heatmap.s.r"},"children":[]}]},{"data":{"id":"d37lhcgteoe8","created":1722822147603,"text":"非度量多维标定法NMDS画图脚本"},"children":[{"data":{"id":"d37lpajda5ts","created":1722822770317,"text":"NMDS.r "},"children":[]}]},{"data":{"id":"d37lhglvzt34","created":1722822156617,"text":"UPGMA聚类树"},"children":[{"data":{"id":"d37lhk71fwg0","created":1722822164426,"text":"bin/beta_div_analysis/UPGMA/plot_upgma.py"},"children":[]}]},{"data":{"id":"d37lhorhqvpc","created":1722822174370,"text":"绘制物种相对丰度的聚类树和累积直方图"},"children":[{"data":{"id":"d37lhsorfqww","created":1722822182912,"text":"bin/beta_div_analysis/cluster_tree_barplot/clusterTree_barplot_analysis.py "},"children":[]}]},{"data":{"id":"d37lhydzvsow","created":1722822195322,"text":"根据距离矩阵绘制箱线图，以显示\n组间的相似性分布。 仅显示样本 >= 3"},"children":[{"data":{"id":"d37li02336kg","created":1722822198955,"text":"bin/beta_div_analysis/distance_matrix_boxplot/distance_matrix_boxplot_analysis.py "},"children":[]}]}]}]}]},{"data":{"id":"d37kbbxbansw","created":1722818855129,"text":"组间差异显著分析"},"children":[{"data":{"id":"d37lqi212rcw","created":1722822865047,"text":"脚本difference_analysis.sh：bin/difference_analysis/difference_analysis_module.py"},"children":[]},{"data":{"id":"d37lr0pv5hc0","created":1722822905670,"text":"结果路径：Analysis_output/Difference_analysis"},"children":[]},{"data":{"id":"d37lrosj3f9c","created":1722822958074,"text":"运行的脚本在：Analysis_output/Difference_analysis/work_sh"},"children":[]},{"data":{"id":"d37lsje1ol4w","created":1722823024680,"text":"分析内容"},"children":[{"data":{"id":"d37lt45cg3cw","created":1722823069865,"text":"ANOVA方差分析，又称F检验（F test）"},"children":[{"data":{"id":"d37ltctiwidc","created":1722823088741,"text":"主要用于检验多个样本的均值是否相等，从而判断两个或两个以上样本的均值差异显著程度"},"children":[]}]},{"data":{"id":"d37luhk77v28","created":1722823177426,"text":"秩和检验是非参数检验的一种方法"},"children":[{"data":{"id":"d37lul1hmdj4","created":1722823185001,"text":"其中“秩”又称等级、即上述次序号的和称“秩和”，秩和检验就是用秩和作为统计量进行假设检验的方法。"},"children":[]}]},{"data":{"id":"d37lvabmt4ow","created":1722823240034,"text":"统计三个变量的不同属性比例，并绘制三元图"},"children":[{"data":{"id":"d37lvvjsmn0g","created":1722823286240,"text":"三元相图是用一个等边三角形描述三个变量的不同属性的比率关系，在分析中可以根据物种分类\n信息对三个或三组样品的物种组成进行比较分析，通过三角图可以直观的显示出不同物种在样品中的比重和关系。"},"children":[]}]},{"data":{"id":"d37lwiqj1gqo","created":1722823336713,"text":"LEfSe分析"},"children":[{"data":{"id":"d37lwsnu91c0","created":1722823358319,"text":"一种将非参数的Kruskal-Wallis以及Wilcoxon秩和检验，与线性判别分析(Linear discriminant analysis，LDA)效应量(Effect size)相结合的分析手段, \n能够在不同组间寻找具有统计学差异的Biomarker，组内样本数小于3个无此分析。"},"children":[]},{"data":{"id":"d37lxqgg3w8w","created":1722823431882,"text":"使用Python LEfse包分析时，首先使用non-parametric factorial Kruskal-Wallis (KW) sum-rank test（非参数因子克鲁斯卡尔—沃利斯和秩验检）\n检测具有显著丰度差异特征，并找到与丰度有显著性差异的类群，然后采用线性判别分析（LDA）来估算每个组分（物种）丰度对差异效果影响的大小。\n结果中通常统计结果表、物种进化分支图，差异物种LDA值分布柱状图、标志物组间丰度柱状图。"},"children":[]}]}]},{"data":{"id":"d37lsmnjmkg0","created":1722823031783,"text":"分析步骤","layout_right_offset":{"x":1,"y":5.999969482421875}},"children":[{"data":{"id":"d37lspqavrb4","created":1722823038480,"text":"方差分析"},"children":[{"data":{"id":"d37lsr2ydhc0","created":1722823041422,"text":"bin/difference_analysis/ANOVA/ANOVA_analysis.py、anova.r、draw_anova.r "},"children":[]}]},{"data":{"id":"d37lts5692ww","created":1722823122097,"text":"秩和检验"},"children":[{"data":{"id":"d37ltvhtehvk","created":1722823129392,"text":"bin/difference_analysis/rank_sum/rankSumTest_analysis.py、rankSumTest.py、draw_rank_sum.r"},"children":[]}]},{"data":{"id":"d37lvho25vcw","created":1722823256023,"text":"三元图"},"children":[{"data":{"id":"d37lvlyoqp6o","created":1722823265373,"text":"bin/difference_analysis/ternary/drawTernary_analysis.py"},"children":[]}]},{"data":{"id":"d37lyiorg7i8","created":1722823493335,"text":"LEfSe分析"},"children":[{"data":{"id":"d37lyshy3zsw","created":1722823514691,"text":"bin/difference_analysis/Lefse/Lefse.pl"},"children":[]}]}]}]}]},"template":"right","theme":"fresh-soil-compat","version":"1.4.43"}