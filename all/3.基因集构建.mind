{"root":{"data":{"id":"d3eogcex70u8","created":1723541452151,"text":"基因集构建"},"children":[{"data":{"id":"d3eoqc1ysd8g","created":1723542235009,"text":"Steps5.genome composition predict"},"children":[{"data":{"id":"d3eoqjzrrv28","created":1723542252290,"text":"调用脚本：gene_predict.py"},"children":[]},{"data":{"id":"d3eoqqrgac5c","created":1723542267025,"text":"id: gene_predict"},"children":[]},{"data":{"id":"d3eor8isnthc","created":1723542305684,"text":"脚本用途"},"children":[{"data":{"id":"d3eor9p81af4","created":1723542308249,"text":"1.从项目配置文件detail.cfg获取最小基因长度阈值，默认100；"},"children":[]},{"data":{"id":"d3eordwlokcg","created":1723542317402,"text":"2.从脚本汇总文件script.cfg中获取MetaGeneMark_mod和gm_key的路径、seqtk软件路径；"},"children":[]},{"data":{"id":"d3eorhp57q4g","created":1723542325658,"text":"3.使用gmhmmp软件进行基因预测gmhmmp -m {MetaGeneMark_mod} -A {protein.fasta} -D {gene.fasta} -f G【L=LST，G=GFF】 -o {gene.gff} 输入的contig.fasta"},"children":[]},{"data":{"id":"d3eornbwfm68","created":1723542337918,"text":"4.对预测结果进行重命名，根据最小基因长度阈值对基因序列进行过滤；"},"children":[]},{"data":{"id":"d3eorrdo4idc","created":1723542346732,"text":"5.使用seqtk subseq对蛋白序列进行提取；最后链接结果文件到output"},"children":[]}]},{"data":{"id":"d3eos57z5jb4","created":1723542376863,"text":"基因预测原理"},"children":[{"data":{"id":"d3eovp78p0qo","created":1723542655447,"text":"同源预测"},"children":[{"data":{"id":"d3eovxbsqdq8","created":1723542673137,"text":"与基因同源序列比对，以与已知基因的序列最大匹配为基础，"},"children":[]},{"data":{"id":"d3eowhup4z5s","created":1723542717815,"text":"优点"},"children":[{"data":{"id":"d3eowj4mhxj4","created":1723542720592,"text":"在测序错误时，预测效果能够保持相对稳定"},"children":[]},{"data":{"id":"d3eowphuuvb4","created":1723542734453,"text":"能够预测出在reference databases中存在相似性的基因"},"children":[]}]},{"data":{"id":"d3eowxvy6p6o","created":1723542752719,"text":"缺点"},"children":[{"data":{"id":"d3eoxetu2k1s","created":1723542789597,"text":"预测依赖于已知的基因信息"},"children":[]},{"data":{"id":"d3eoxj8jot8g","created":1723542799193,"text":"不能注释出在数据库中缺少功能相似性序列的基因"},"children":[]},{"data":{"id":"d3eoxkgx08w0","created":1723542801876,"text":"不能发现novel or new 基因"},"children":[]},{"data":{"id":"d3eoxqntbitc","created":1723542815354,"text":"计算资源消耗过大，时间花费过长"},"children":[]}]},{"data":{"id":"d3eoxs0qp81s","created":1723542818312,"text":"软件:DOGMA，MITOS，Genewise"},"children":[]}]},{"data":{"id":"d3eoxw055tds","created":1723542826983,"text":"从头预测"},"children":[{"data":{"id":"d3eoy9160s1s","created":1723542855343,"text":"根据给定的序列特征来预测，主要依赖于在编码区和非编码区拥有不同特征的信息，并在统计学上进行描述，构建概率模型，用以区别编码与非编码区;"},"children":[]},{"data":{"id":"d3eoynzl1erk","created":1723542887900,"text":"算法"},"children":[{"data":{"id":"d3eoyuvzutj4","created":1723542902920,"text":"The hidden Markov models (HMM)"},"children":[]},{"data":{"id":"d3eoyw15ub5s","created":1723542905409,"text":"Support vector machines(SVM)"},"children":[]},{"data":{"id":"d3eoz0pqkjr4","created":1723542915602,"text":"Artificial neural networks (ANN)"},"children":[]}]},{"data":{"id":"d3eozoebuj28","created":1723542967155,"text":"优点"},"children":[{"data":{"id":"d3eozsuauakg","created":1723542976828,"text":"采用的features包括: codon usage, start/stop codon"},"children":[]},{"data":{"id":"d3ep08ge9i4g","created":1723543010816,"text":"能够预测出已知的和未知的基因"},"children":[]},{"data":{"id":"d3ep0bv1pa0w","created":1723543018232,"text":"计算资源消耗小，时间花费少"},"children":[]}]},{"data":{"id":"d3ep0huu9af4","created":1723543031281,"text":"缺点"},"children":[{"data":{"id":"d3ep0k6qow00","created":1723543036353,"text":"对测序错误敏感"},"children":[]}]},{"data":{"id":"d3ep0pv4o6ps","created":1723543048712,"text":"软件：GeneMark、【MetaGeneMark】、MetaGene 、MetaGeneAnnotator、FragGeneScan"},"children":[]}]}]},{"data":{"id":"d3h800pi9jwg","created":1723799714954,"text":"输入输出","progress":9},"children":[{"data":{"id":"d3h80rl9hatc","created":1723799773471,"text":"输入"},"children":[{"data":{"id":"d3h823r0cav4","created":1723799878304,"text":"序列进行组装，并经过长度过滤的contigs.fasta序列文件"},"children":[]}]},{"data":{"id":"d3h80ugx9pfk","created":1723799779739,"text":"输出：每个样本"},"children":[{"data":{"id":"d3h80ww146ww","created":1723799785006,"text":"基因集预测得到的gene.fasta、protein.fasta、gene.gff，并对序列进行一定长度阈值过滤后的序列"},"children":[]},{"data":{"id":"d3eos3s3dekg","created":1723542373726,"text":"输出文件夹：gene_predict_*"},"children":[]}]}]}]},{"data":{"id":"d3ep46xi8d8g","created":1723543320954,"text":"Steps5.genome composition predict stat"},"children":[{"data":{"id":"d3ep4985onb4","created":1723543325951,"text":"二代：gene_stat_cwl.py"},"children":[]},{"data":{"id":"d3ep5q0tpfr4","created":1723543440877,"text":"三代：gene_predict_stat.py"},"children":[]},{"data":{"id":"d3ep5ysccv7k","created":1723543459955,"text":"脚本作用","expandState":"expand"},"children":[{"data":{"id":"d3ep61jcnqww","created":1723543465942,"text":"1.基因预测结果统计，包括基因长度、平均长度、最大长度等，并进行⻓度分布图绘制"},"children":[]}]},{"data":{"id":"d3h88tn3pcsg","created":1723800404849,"text":"统计所有样本的基因预测结果，得到gene_stat.xls总表","progress":9},"children":[]}]},{"data":{"id":"d3ep77rwq03k","created":1723543557884,"text":"Steps5.genome composition predict stat backup"},"children":[{"data":{"id":"d3ep7glaslj4","created":1723543577076,"text":"使用zip -rq 压缩结果"},"children":[]}]},{"data":{"id":"d3ep7owtht6o","created":1723543595187,"text":"非冗余基因集构建"},"children":[{"data":{"id":"d3epdxmwuolc","created":1723544084367,"text":"6.1 build non-redundant geneset"},"children":[{"data":{"id":"d3f82avm9wcg","created":1723596773906,"text":"二代：build_nr_geneset_cwl.py"},"children":[]},{"data":{"id":"d3f82vem9rsw","created":1723596818591,"text":"三代：build_nr_geneset.py"},"children":[]},{"data":{"id":"d3f83454buo0","created":1723596837608,"text":"脚本作用"},"children":[{"data":{"id":"d3f837b1fp4w","created":1723596844496,"text":"1.cat合并【所有样本】基因预测并进行过滤后得基因序列gene.fasta、cat合并过滤后的蛋白序列protein.fasta；"},"children":[]},{"data":{"id":"d3f83bz14g00","created":1723596854654,"text":"2.使⽤mmseq进⾏⾮冗余基因集构建，参数如下：mmseqs easy-linclust 合并的蛋白序列 蛋白基因集 临时目录 \n--min-seq-id 蛋白序列聚类相似度，一般0.9  --cov-mode 1 --threads 4 -c 蛋白序列聚类覆盖度默认0.9；"},"children":[]},{"data":{"id":"d3f83sdj8ef4","created":1723596890359,"text":"3.将结果中聚类的id从蛋白的改成cds的id，再从蛋白的聚类结果中挑选出cds的id文件，使用seqtk subseq 从合并的基因序列中提取出基因集的fasta序列；"},"children":[]},{"data":{"id":"d3f83yngjabk","created":1723596904020,"text":"4.length_distir.pl画长度分布图。"},"children":[]}]},{"data":{"id":"d3h7d9qst9mo","created":1723797932248,"text":"得到的结果：是非冗余基因集的基因序列和蛋白序列","progress":9},"children":[]},{"data":{"id":"d3h6vj5b7uo0","created":1723796542161,"text":"注：所有样本分别合并基因预测过滤后的基因序列和蛋白序列","priority":1},"children":[]}]},{"data":{"id":"d3f86emwqp6o","created":1723597095544,"text":"Steps6.2 geneset_abudance"},"children":[{"data":{"id":"d3f86fxy4a2o","created":1723597098388,"text":"脚本：geneset_abundance_cal.py"},"children":[]},{"data":{"id":"d3f86omawidc","created":1723597117276,"text":"脚本作用"},"children":[{"data":{"id":"d3f86qwm86io","created":1723597122253,"text":"1.对sort.bam文件使用samtools index加索引；"},"children":[]},{"data":{"id":"d3f86z24tts0","created":1723597140000,"text":"2.对基因集预测gff文件与非冗余基因集聚类的结果文件进行合并处理成类似bed格式；"},"children":[]},{"data":{"id":"d3f873p8t43k","created":1723597150104,"text":"3.使用samtools bedcov进行丰度计算。"},"children":[]}]},{"data":{"id":"d3h8e6cawy68","created":1723800824315,"text":"输入输出","progress":9},"children":[{"data":{"id":"d3h8ebivvdog","created":1723800835597,"text":"输入"},"children":[{"data":{"id":"d3h8evgn3w8w","created":1723800878997,"text":"高质量fastq与组装过滤的fasta比对结果，进行排序后的sorted.bam文件"},"children":[]},{"data":{"id":"d3h8jbclhtkw","created":1723801227037,"text":"基因集预测gff文件*_gene.gff"},"children":[]},{"data":{"id":"d3h8nu1yjxfk","created":1723801581210,"text":"非冗余基因集构建：聚类的结果文件geneset_cluster.tsv【all sample】"},"children":[]}]},{"data":{"id":"d3h8eclc69kw","created":1723800837922,"text":"输出"},"children":[{"data":{"id":"d3h8optq3474","created":1723801650369,"text":"样本的基因集的丰度信息统计文件：*"},"children":[]}]},{"data":{"id":"d3h8ejl7ubr4","created":1723800853152,"text":"分支主题"},"children":[]}]}]},{"data":{"id":"d3f87ot65og0","created":1723597196054,"text":"Steps6.2 geneset_abudance_stat"},"children":[{"data":{"id":"d3f86fxy4a2o","created":1723597098388,"text":"脚本：geneset_abundance_stat.py"},"children":[]},{"data":{"id":"d3f897yp5t6o","created":1723597316112,"text":"脚本作用"},"children":[{"data":{"id":"d3f89b6xrc3k","created":1723597323140,"text":"1.合并非冗余geneset的结果统计总的丰度表得到geneset.abundance和geneset.relabundance；"},"children":[]},{"data":{"id":"d3f89cdlzb40","created":1723597325720,"text":"2.根据Sum阈值统计样本的丰度表"},"children":[]}]},{"data":{"id":"d3h6vj5b7uo0","created":1723796542161,"text":"注：所有样本非冗余基因集的丰度信息合并","priority":1},"children":[]}]},{"data":{"id":"d3f89md1v7k0","created":1723597347454,"text":"Steps6.2 geneset_abudance backup"},"children":[{"data":{"id":"d3f89zjx2o00","created":1723597376168,"text":"二代：geneset_abundance_backup.py"},"children":[]},{"data":{"id":"d3f8a209jpj4","created":1723597381510,"text":"三代：geneset_abundance_stat_backup.py"},"children":[]},{"data":{"id":"d3f8a4sgbtog","created":1723597387568,"text":"脚本作用"},"children":[{"data":{"id":"d3f8ahaop14w","created":1723597414792,"text":"1.geneset丰度统计结果备份。"},"children":[]}]}]}]}]},"template":"right","theme":"fresh-pink-compat","version":"1.4.43"}