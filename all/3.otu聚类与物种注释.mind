{"root":{"data":{"id":"d36yyum5jocg","created":1722758633771,"text":"3.otu聚类与物种注释","expandState":"expand"},"children":[{"data":{"id":"d36yzav4yy9s","created":1722758669142,"text":"脚本cluster_seqs.sh：bin/cluster_seqs/cluster_seq.py","expandState":"expand"},"children":[{"data":{"id":"d36yzks0mxog","created":1722758690722,"text":"输入参数：script.cfg、detail.cfg【会有使用什么聚类方式以及注释方式】"},"children":[]},{"data":{"id":"d36yzzzjy6tc","created":1722758723829,"text":"输出shell路径：Qiime_analysis/Analysis_results/otus/work_sh"},"children":[]},{"data":{"id":"d36z0g4tighs","created":1722758758976,"text":"聚类参数：cluster_method，主要2中dada2和非dada2【usearch】"},"children":[]},{"data":{"id":"d36z12nr8feo","created":1722758808010,"text":"注释参数：1.序列比对blast、2.朴素贝叶斯分类器bayesian、3.序列比对结合朴素贝叶斯分类器all "},"children":[]},{"data":{"id":"d36zhrysob9c","created":1722760116924,"text":"输出结果路径：Qiime_analysis/Analysis_results/otus"},"children":[]}]},{"data":{"id":"d36z1m78dfr4","created":1722758850547,"text":"首先看cluster_method的方法是不是dada2"},"children":[{"data":{"id":"d36z1qesavi8","created":1722758859711,"text":"dada2"},"children":[{"data":{"id":"d36z259xh340","created":1722758892069,"text":"若使用得是dada2的方法，上游的dada2已经有输出作为本次输入：Contigs/dada2/table.tsv"},"children":[]},{"data":{"id":"d36z293uyhvk","created":1722758900409,"text":"将dada2的结果转成表：未过滤的tab文件；\n再使用biom软件将未过滤的tab文件转换成未过滤的BIOM 格式文件。","layout_right_offset":{"x":0,"y":12}},"children":[]}]},{"data":{"id":"d36z1t2dfdvk","created":1722758865490,"text":"非dada2","layout_right_offset":{"x":-2,"y":12},"expandState":"expand"},"children":[{"data":{"id":"d36z31utlkao","created":1722758962989,"text":"先看是否所有fq合并成tag.fasta，没合并先合并；","layout_right_offset":{"x":-2,"y":0}},"children":[]},{"data":{"id":"d36z3a44dkhs","created":1722758980965,"text":"合并后调用run_usearch函数，该函数的作用"},"children":[{"data":{"id":"d36z5ln5m4g0","created":1722759162789,"text":"第一步\n序列去重","expandState":"expand"},"children":[{"data":{"id":"d36z3j3xetq8","created":1722759000545,"text":"vsearch --derep_fulllength tag.fasta -output uniq.fasta --minuniquesize 1 --sizeout"},"children":[]},{"data":{"id":"d36z5pyj0u80","created":1722759172184,"text":"--derep_fulllength 对序列进行去重，该参数用于去除输入文件中的重复序列，确保每个序列仅保留一个代表。"},"children":[]},{"data":{"id":"d36z5wftksg0","created":1722759186290,"text":"--minuniquesize 设置最小唯一序列大小，参数设定了最小的唯一序列大小为1。"},"children":[]},{"data":{"id":"d36z62nqkhkw","created":1722759199830,"text":"--sizeout 参数告诉 vsearch 在输出的结果文件中包含每个序列的大小信息"},"children":[]},{"data":{"id":"d36z69vcvbi8","created":1722759215528,"text":"对于--minuniquesize参数，全长full是1，非全长是3"},"children":[]}]},{"data":{"id":"d36z7827wirk","created":1722759289954,"text":"第二步"},"children":[{"data":{"id":"d36z7saqsvsw","created":1722759334005,"text":"查看去重后的数据量如何，再决定使用什么样的参数进行聚类"},"children":[]},{"data":{"id":"d36z7ulof400","created":1722759339019,"text":"若去重数据量/(1024.0**3) <= 1"},"children":[{"data":{"id":"d36z8n8nusjk","created":1722759401359,"text":"指定了按97%聚类的话","expandState":"expand"},"children":[{"data":{"id":"d36z850idi4g","created":1722759361684,"text":"usearch -cluster_otus 输入uniq序列 -otus 输出未过滤fa -uparseout %s -relabel OTU -minsize"},"children":[]}]},{"data":{"id":"d36z8qn6a134","created":1722759408767,"text":"若没有指定97%阈值的话参数"},"children":[{"data":{"id":"d36z8ur4r3eo","created":1722759417713,"text":"usearch -cluster_fast 输入uniq序列 -centroids 输出未过滤fa -uc %s -relabel OTU -id 指定的过滤阈值 -minsize"},"children":[]}]}]},{"data":{"id":"d36z970710qo","created":1722759444383,"text":"如果去重数据量/(1024.0**3)>1"},"children":[{"data":{"id":"d36z9pe5xmo0","created":1722759484409,"text":"直接使用vsearch聚类OTU"},"children":[{"data":{"id":"d36z9uj6kveo","created":1722759495597,"text":"vsearch -cluster_fast 输入uniq序列 -centroids %s -uc %s -relabel OTU -id "},"children":[]}]}]},{"data":{"id":"d36za73q8s8w","created":1722759522961,"text":"输出文件"},"children":[{"data":{"id":"d36zaa99dc00","created":1722759529825,"text":"质心序列文件 (-centroids %s)：包含每个 OTU 的质心序列。"},"children":[]},{"data":{"id":"d36zae7fya68","created":1722759538423,"text":"聚类信息文件 (-uc %s)：详细描述每个输入序列及其分配给的 OTU 的信息。"},"children":[]}]}]},{"data":{"id":"d36zaxxauolc","created":1722759581345,"text":"第三步"},"children":[{"data":{"id":"d36zbli6w4jk","created":1722759632674,"text":"全局序列比对算法将tags.fasta与参考序列比对"},"children":[]},{"data":{"id":"d36zbn41b37k","created":1722759636172,"text":"命令：vsearch --usearch_global %s --db %s -otutabout %s -biomout %s -strand plus -id %s --threads 4"},"children":[]},{"data":{"id":"d36zbs7n4f7k","created":1722759647274,"text":"输出"},"children":[{"data":{"id":"d36zbxm9ml8g","created":1722759659042,"text":"未过滤的BIOM 格式文件，用于存储多样本序列数据及其注释信息"},"children":[]},{"data":{"id":"d36zc5v7z5ds","created":1722759676998,"text":"输出 OTU 表，包含每个 OTU 在每个样本中的丰度信息"},"children":[]},{"data":{"id":"d36zcjjgvhts","created":1722759706762,"text":"-strand plus确保比对时考虑序列的正链方向，对于核酸序列特别重要。"},"children":[]}]}]}]}]}]},{"data":{"id":"d36zd6g6syrk","created":1722759756630,"text":"dada2、vsearch或usearch得到的未过滤的biom"},"children":[{"data":{"id":"d36zeenm6bcw","created":1722759852857,"text":"过滤脚本filter_feature.sh：bin/cluster_seqs/filter_OTU_from_OTU_table.py"},"children":[]},{"data":{"id":"d36zf5goam0w","created":1722759911211,"text":"过滤参数选择：自动过滤、根据最小值过滤、最小特征过滤、最小ratio过滤"},"children":[]},{"data":{"id":"d36zfjj7q8zk","created":1722759941839,"text":"过滤后输出"},"children":[{"data":{"id":"d36zfmyqjaps","created":1722759949308,"text":"输出otu表转Json和转tsv的格式"},"children":[]},{"data":{"id":"d36zfrdcrshs","created":1722759958899,"text":"输出rep_set.unfilter.fasta"},"children":[]}]}]},{"data":{"id":"d36zh85midj4","created":1722760073801,"text":"有序列之后就调用函数classify_seqs进行聚类"},"children":[{"data":{"id":"d36zhedqlbls","created":1722760087352,"text":"脚本classify_seq.sh：bin/cluster_seqs/classify_seq.py"},"children":[]},{"data":{"id":"d36ziju3dwqo","created":1722760177589,"text":"注释策略有：blast、bayesian、all【blast+usearch+minimap2+bayesian：按顺序一层层的判断往后走】"},"children":[]},{"data":{"id":"d36ziq5yfojk","created":1722760191367,"text":"注释结果在Qiime_analysis/Analysis_results/otus/tmp下"},"children":[]},{"data":{"id":"d36zj549h340","created":1722760223917,"text":"Qiime_analysis/Analysis_results/otus/work_sh会有相应的shell"},"children":[{"data":{"id":"d36zj94a629s","created":1722760232625,"text":"blast方法：blast.sh"},"children":[]},{"data":{"id":"d36zjdae337k","created":1722760241702,"text":"bayesian方法：qiime2.sh"},"children":[]},{"data":{"id":"d36zjgk8xiio","created":1722760248828,"text":"minimap方法：minimap2.sh"},"children":[]}]},{"data":{"id":"d36zjqzudj40","created":1722760271539,"text":"异常记录"},"children":[{"data":{"id":"d36zjue4fv28","created":1722760278933,"text":"描述：otu聚类这步骤失败了，原因是在功能基因物种分类不能选all方法，改选贝叶斯bayesian"},"children":[]},{"data":{"id":"d36zk45kp3pc","created":1722760300183,"text":"处理：后台容器里改detail.cfg和项目目录下主work.sh，前端点续跑"},"children":[]}]}]},{"data":{"id":"d36zl63ettkw","created":1722760382770,"text":"有注释结果后，生成：\nqiime  phylogeny align-to-tree-mafft-fasttree"},"children":[{"data":{"id":"d36zl9gtkykg","created":1722760390112,"text":"用于生成进化树的命令，结合了序列比对（MAFFT）和树构建（FastTree）的步骤。"},"children":[]},{"data":{"id":"d36zlqmh0e80","created":1722760427459,"text":"该命令用于序列比对并构建物种或 OTU 的进化树。"},"children":[]}]},{"data":{"id":"d36zmcq6r0n4","created":1722760475572,"text":"下一步获得各个OTU/ASV的taxonomy各层级的信息：rep_set_tax_assignments.txt"},"children":[]},{"data":{"id":"d36zmuiaklq8","created":1722760514277,"text":"汇总结果：summarize_table.sh"},"children":[{"data":{"id":"d36zn7txtj40","created":1722760543280,"text":"biom软件有 add-metadata、convert和summarize-table的方法"},"children":[]},{"data":{"id":"d36zn930jthc","created":1722760546005,"text":"同时会使用到两个脚本"},"children":[{"data":{"id":"d36znfzfkhs0","created":1722760561027,"text":"bin/cluster_seqs/../00.check/check_biomSample.py"},"children":[]},{"data":{"id":"d36znh6nmkg0","created":1722760563639,"text":"bin/cluster_seqs/eachsample_annotate_ratio.py"},"children":[]}]}]}]},"template":"right","theme":"fresh-purple-compat","version":"1.4.43"}